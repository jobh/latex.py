%% -*- mode: LaTeX -*-
\input{header}

%@EXEC_ = r'%@ '
%@PREFIX_ = '\\'

%@ M  = r'\mathrm{%s}'
%@ R  = r'\text{%s}'
%@ X  = r'\M{%s}'
%@ MM = r'\mathcal{%s}'
%@ del = r'\partial'

\begin{document}

%\NAG{<first page>}{<last page>}{<volume>}{<issue>}{<yy>}
\NAG{0}{0}{0}{0}{00}
\runningheads{J.~B.~Haga \emph{et al.}}{Pressure oscillations in low-permeable porous media}
\noreceived{}%\received{<date>}
\norevised{}%\revised{<date>}
\noaccepted{}%\accepted{<date>}

\title{Pressure oscillations and locking in low-permeable and incompressible porous media}
\author{
  Joachim Berdal Haga\affil{1}\comma\affil{2}\comma\corrauth,
  Harald Osnes\affil{1}\comma\affil{2} and
  Hans Petter Langtangen\affil{1}\comma\affil{3}}
\address{%
\affilnum{1}\ Scientific Computing Department, Simula Research Laboratory, Norway\\
\affilnum{2}\ Department of Mathematics, University of Oslo, Norway\\
\affilnum{3}\ Department of Informatics, University of Oslo, Norway\\
\todop{\version}
}
\corraddr{%
J.~B.~Haga, Simula Research Laboratory, 
PO Box 134, N-1325 Lysaker, Norway. E-mail: jobh@simula.no}
%\footnotetext[2]{E-mail: jobh@simula.no}
\cgs{Statoil ASA}
\cgs{Norwegian Research Council}

\begin{abstract}
%
Large-scale simulations of flow in deformable porous media require

We argue that pressure oscillations in low-permeable porous media should be
understood as a failure to satisfy the inf-sup condition on the finite element
spaces, rather than as a failure to represent a nearly divergence-free
displacement solution (locking).
This understanding makes it possible to use the established library of
inf-sup-stable elements as a guideline for choosing finite element spaces
for Biot's equations.
\end{abstract}
\keywords{Biot's consolidation; pressure oscillations; elastic locking; low-permeable media; 
incompressible media; finite elements}

\section{Introduction}
The locking phenomenon in elasticity is well known to cause spurious
oscillations in the (solid) pressure and erroneous displacement solutions for
nearly incompressible materials.
A similar phenomenon can be seen in poroelasticity when low-permeable regions
are present.
In the latter case, oscillations can be observed in the fluid pressure. In
[ref], Phillips et al.~argue that these phenomena come from the same
fundamental problem: the reduction of effective degrees of freedom in the
displacement solution when the finite elements are required to be (nearly)
divergence-free, $\nabla \cdot \U\approx 0$.

In the present paper, we test this hypothesis numerically by employing the
mixed finite element formulation for the displacement fielt in the poroelastic
equations.
Furthermore, we look at ways to overcome the pressure oscillations in
low-permeable materials without resorting to Discontinuous Galerkin methods
(which have been shown ito alleviate the problem [ibid.]).

\section{The mathematical model}

The equations describing poroelastic flow and deformation can be derived from
the principles of conservation of fluid mass and the balance of forces on the
porous matrix.
%
The linear poroelastic equations can, in the small-strains regime, be
expressed as
%
\begin{align}
\label{eq:sim1}
S\dot{\Pf} - \nabla \cdot \Lambda \nabla \Pf + \alpha \nabla \cdot \dot{\U} &= q, \\
\label{eq:sim2}
\nabla (\lambda+\mu) \nabla \cdot \U + \nabla \cdot \mu \nabla \U
 -  \alpha \nabla \Pf &= \V{r}.
\end{align}
%
Here, we subsume body forces such as gravitational forces into the right-hand
side source terms $q$ and $\V{r}$.
The primary variables are $\Pf$ for the fluid pressure and $\U$ for the
displacement of the porous medium, $S$ and $\Lambda$ are the fluid storage
coefficient and the flow mobility respectively, $\alpha$ is the Biot-Willis fluid/solid
coupling coefficient, and $\lambda$ and $\mu$ are the Lam\'e elastic parameters.

The fluid (Darcy) velocity is often of particular interest in poroelastic
calculations.
It can be written
\begin{equation}
  \label{eq:vD}
  \vD= -\Lambda \nabla \Pf,
\end{equation}
and represents the net macroscopic flux.
%
For the displacement equation, the main secondary quantity of interest is the
effective stress tensor,
\begin{align}
  \label{eq:sigma}
  \tilde{\VV{\sigma}} &= (\alpha \Pf + \Ps) \VV{I} +
  \mu\VV{(\nabla \U + \T{(\nabla \U)})},\\
  \intertext{which is written here using the solid pressure}
  \label{eq:Ps}
  \Ps &= -\lambda \nabla \cdot \U.
\end{align}

\subsubsection*{Weak discrete-in-time form.}

We employ a first-order backward finite difference method in time, which leads
to the discrete-time form of \refeq{sim1}
%
\begin{equation}
  \label{eq:time1}
  S \Pf - \Delta t\nabla \cdot \Lambda \nabla \Pf
  +  \nabla \cdot \U = q\Delta t + S \prev{\Pf} + \nabla \cdot \prev{\U}.
\end{equation}
%
where $(\prev{\Pf},\prev{\U})$ use values from the previous time step,
while unmarked variables are taken to be at the current time step.

Next, we rewrite \refeqs{sim2}{time1} in
weak form, using integration by parts to eliminate second derivatives.
The following relations must then be satisfied for all test functions $\pi$ and
$\V{\omega}$ in the domain $\Omega$:
%
\begin{gather}
  \label{eq:weakpress}
  \int_\Omega [
    \pi(
  S \Pf
  + \nabla \cdot \U)
  + \Delta t \nabla\pi \cdot \Lambda \nabla \Pf
  ] \D\Omega 
  = \int_\Omega \pi[
    q \Delta t
  + S \prev{\Pf}
  + \nabla \cdot \prev{\U}] \D\Omega
-\int_\Gamma \pi f_{\V{n}}\Delta t \D\Gamma,\\
%
\label{eq:weakdispl}
  \int_\Omega [
  (\nabla\cdot\V{\omega})((\lambda+\mu)(\nabla\cdot\U)
  -\alpha \Pf)
  +\nabla \V{\omega} : \mu  \nabla \U
  ] \D\Omega =
 - \int_\Omega \V{\omega} \cdot \V{r} \D\Omega + \int_\Gamma \V{\omega}
  \cdot \V{t}_{\V{n}} \D\Gamma.
\end{gather}
%
The normal flux $f_{\V{n}}=\vD\cdot\V n$ and normal stress $\V{t}_{\V{n}}$ on the boundary
$\Gamma$ appear here as natural boundary conditions. 
The discrete finite element approximation follows from solving
\refeqs{weakpress}{weakdispl} in finite-dimensional spaces.

\subsection{Mixed fluid pressure-velocity formulation}

In many applications of the poroelastic equations, we are mainly interested in
the flow of the fluid through the medium.
However, due to the differential operator acting on $\Pf$ it is of lower accuracy than
the pressure $\Pf$ itself.
Furthermore, the derivative is not continuous between elements, and hence the
fluid mass is not conserved.
A natural extension is then to introduce $\vD$ as an extra primary variable in a mixed
finite element formulation.
The order of accuracy is higher, and continuous elements for $\vD$ ensure mass
conservation.

By inserting \refeq{vD} into \refeq{sim1}, we get a coupled system of three
equations (of which two are vector equations). \Refeq{sim2} for solid
displacement is unchanged, and the equations for fluid flux and pressure are
\begin{align}
\label{eq:simp1}
S\dot{\Pf} + \nabla \cdot \vD + \alpha \nabla \cdot \dot{\U} &= q, \\
\label{eq:simp2}
  \Lambda^{-1} \vD + \nabla \Pf &= 0.
\end{align}
We shall call this the mixed fluid pressure, or mixed-$\Pf$, formulation.

\subsubsection*{Weak discrete-in-time form.}

Following the same conventions as in the previous section, \refeq{weakpress}
becomes the two coupled equations
\begin{gather}
  \label{eq:weakpressmix}
  \int_\Omega \pi[
  S \Pf +
  \Delta t \nabla \cdot \vD
  + \nabla \cdot \U
  ] \D\Omega 
  = \int_\Omega \pi[
  q \Delta t
  + S \prev{\Pf}
  + \nabla \cdot \prev{\U}] \D\Omega,\\
%
\label{eq:weakdarcy}
  \int_\Omega [
  \V{\phi} \cdot \Lambda^{-1}\vD - (\nabla \cdot \V{\phi})\Pf
  ]  \D\Omega
  + \int_\Gamma (\V{\phi}\cdot \V{n}) \Pf = 0,
\end{gather}
for any test functions $\pi$ and $\V{\phi}$ in the appropriate spaces.
The integration by parts in \refeq{weakdarcy} is undertaken to avoid
taking the derivative of $\Pf$, which is usually of low order (and possibly
piecewise constant).

\subsection{Mixed solid displacement-pressure formulation}

In the field of (pure) elasticity, it is well understood that a
low-compressible material (with Poisson's ratio close to $0.5$) leads to
unphysical oscillations in the solid pressure field, and in some cases also to
a wrong solution for the calculated displacement.
This can be explained by $\lambda$ becoming very large in \refeq{sim2}, leading to
the requirement that $\nabla\cdot\U\rightarrow 0$.
When this requirement is applied to standard finite elements, several degrees
of freedom become ``locked'', leaving too few degrees of freedom to represent
the correct solution.

One way to overcome this obstacle is to introduce a new primary variable for
the solid pressure, which is defined in \refeq{Ps}.
\Refeq{sim2} can then be rewritten as two coupled equations,
\begin{align}
\label{eq:mixu1}
\nabla \mu \nabla \cdot \U + \nabla \cdot \mu \nabla \U
 - \nabla \Ps - \alpha \nabla \Pf &= \V{r},\\
\label{eq:mixu2}
\lambda^{-1}\Ps+\nabla\cdot\U &= 0,
\end{align}
and combined with either \refeq{sim1} or with \refeqs{simp1}{simp2}.
In either case, we replace $\alpha \nabla \cdot \dot{\U}$ by $- \alpha
\lambda^{-1} \dot{\Ps}$; the reason for this change will be elucidated in later
sections.
The mixed solid displacement, or mixed-$\U$, formulation is stable for
low-compressible or even incompressible materials.

\subsubsection*{Weak discrete-in-time form.}

The weak form of \refeqr{mixu1}{mixu2} is
\begin{gather}
  \label{eq:weakpressmix2}
  \int_\Omega [\pi(
  S \Pf
  - \lambda^{-1} \Ps)
  + \Delta t \nabla\pi \cdot \Lambda \nabla \Pf
  ] \D\Omega 
  = \int_\Omega \pi[
   q \Delta t
  + S \prev{\Pf}
  - \lambda^{-1} \prev{\Ps}] \D\Omega
-\int_\Gamma \pi f_{\V{n}}\Delta t \D\Gamma,\\
%
\label{eq:weakdisplmix}
  \int_\Omega [
  (\nabla\cdot\V{\omega})(\mu(\nabla\cdot\U)
  -\alpha \Pf - \Ps)
  +\nabla \V{\omega} : \mu  \nabla \U
  ]  \D\Omega = - \int_\Omega \V{\omega} \cdot \V{r} \D\Omega + \int_\Gamma \V{\omega}
  \cdot \V{t}_{\V{n}} \D\Gamma,\\
%
\label{eq:weaks}
  \int_\Omega \psi[
     \lambda^{-1}\Ps + \nabla \cdot \U 
  ]  \D\Omega
  = 0,
\end{gather}
for test functions $\pi$, $\V{\omega}$ and $\psi$ in the appropriate spaces.
Finally, the trailing term on both sides of \refeq{weakpressmix2} can be replaced in the
same way as in \refeqr{weakpressmix}{weakdarcy} to produce a doubly mixed
system of two vector unknowns and two scalar unknowns.

\section{On the cause of pressure oscillations}

\subsection{Hypo1}

In [ref], Phillips et al.~argue that the cause of pressure oscillations in
low-permeable media is the same: Consider \refeq{sim1}, discretised in time
with time step $\Delta t$ and with $S=q=0$.
Assume furthermore that we take one time step from a state with
$\nabla\cdot\U=0$.
Then,
\begin{equation}
  \nabla\cdot\U \approx \varepsilon \onabla^2 \Pf,
\end{equation}
with $\varepsilon=\Delta t \Lambda / \alpha,$ which becomes very small for
short time steps and low permeabilities.
Again, we see the requirement for a divergence-free solution for the
displacement $\U$.

Assuming this the case, we can combine the mixed-$\Pf$ and the mixed-$\U$
approaches, and introduce the solid pressure into the equation for the fluid
pressure, i.e., \refeqs{sim1}{simp1}.\footnote{As a practical issue, we note
  that this destroys the symmetry of the equations, with consequences for the
  choice of iterative solver for the discretised system.}
This doubly mixed system of two vector variables and two scalar variables can be
written as
\begin{align}
S\dot{\Pf} + \nabla \cdot \vD + \alpha \lambda^{-1} \dot{\Ps} &= q, \\
\label{eq:mixp}
  \Lambda^{-1} \vD + \nabla \Pf &= 0,\\
\nabla \mu \nabla \cdot \U + \nabla \cdot \mu \nabla \U
 - \nabla \Ps - \alpha \nabla \Pf &= \V{r},\\
\label{eq:mixu}
\lambda^{-1}\Ps+\nabla\cdot\U &= 0,
\end{align}
from which \refeq{mixp} and/or \refeq{mixu} may be eliminated, producing any of
the mixed formulations above.

\section{Losing the plot}

The domain of the first test problem is shown in \reffig{domain}.
Since we have not found any analytical solutions for the poroelastic equations
with different material parameters, we use this test problems in two ways: If
the load placed on the top boundary is uniform, it reduces to a one dimensional
problem, with a straightforward analytical solution.
Otherwise, we use the simple fact that the total equivalent volumetric stress,
\begin{equation}
\trace{\tilde{\sigma}} = \Ps + \alpha \Pf + 2\mu \nabla\cdot\U,
\end{equation}
should be continuous, smooth and monotonically non-increasing from top to bottom
under simple loading conditions.
This does not ensure that the numerical solution converges, but it is easy to
identify both oscillatory solutions and also some plausible but wrong ones
--- see, e.g., \reffig{asymm/Q0,RT1,Q1,-,all}b where each component field is smooth
but the fluid pressure is too high / solid pressure is too low.
For comparison, \reffig{asymm/Q0,RT1,Q1,Q0}b shows the correct (or at least
apparently so) solution: the load is balanced initially (in the top layer) by
solid pressure; then the fluid pressure takes over in the middle layer; and
finally, in the bottom layer, a combination of fluid/solid pressure and
volumetric strain.

\fig{domain}{The test domain. On the sides and bottom, no-flux conditions are
  imposed so that no fluid or solid movement is allowed in the normal
  direction. The top is drained with fluid pressure $\Pf=0$ and an applied normal
  stress (load).}

\fig[width=\textwidth]{symm/Q1,-,Q1,-,all}{Uniform load}
\fig[width=\textwidth]{symm/Q0,RT1,Q1,-,all}{Uniform load, mixed-$\Pf$}

\fig[width=\textwidth]{asymm/Q1,-,Q1,-,all}{Asymmetric load}
\fig[width=\textwidth]{asymm/Q0,RT1,Q1,-,all}{Asymmetric load, mixed-$\Pf$}
\fig[width=\textwidth]{asymm/Q1,-,Q1,Q0,all}{Asymmetric load, mixed-$\U$}
\fig[width=\textwidth]{asymm/Q0,RT1,Q1,Q0,all}{Asymmetric load, mixed-both}


\section{Getting back on track}

\twofig{symm/Q1,-,Q1,-,EPS-14}{Uniform}{asymm/Q1,-,Q1,-,EPS-14}{Asymm}{Compare}

Elastic locking only appears with rotation, compare \reffig{symm/Q1,-,Q1,-,all}
with \reffig{asymm/Q1,-,Q1,-,all}.

\twofig{symm/Q1,-,Q1,Q1,EPS-14}{$Q^1$}{symm/Q2,-,Q2,Q2,EPS-14}{$Q^2$}{Compare}
\twofig{symm/Q1,-,Q2,Q1-,EPS-14}{Continuous $\Pf$}{symm/Q1-,Q2,Q2,Q1-,EPS-14}{Mixed-$\Pf$}{Compare}

Without rotation, but with intentional violation of inf-sup,
\reffig{symm/Q1,-,Q1,Q1,EPS-14:both}.

Drop order of $\Pf$/$\Ps$, \reffig{symm/Q1,-,Q2,Q1-,EPS-14:both}.

\section{Concluding remarks}



\acks


\bibliography{../references}
\bibliographystyle{wileyj}

\end{document}
